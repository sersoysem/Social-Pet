{% extends "home.html" %}
{% block title %}Etkinlik OluÅŸtur | Social Pet{% endblock %}

{% block main_content %}
<style>
.create-event-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 32px;
    padding: 0 8px;
    width: 100%;
}
.event-title-header {
    color: #3f3f3f;
    font-size: 28px;
    left: 0;
    letter-spacing: 0.5px;
}
.create-btn-wrapper {
    display: flex;
    align-items: flex-start;
    justify-content: flex-end;
    flex: 1;
}
.create-event-btn {
    background: #ff6b35;
    color: white;
    border: none;
    border-radius: 12px;
    padding: 12px 24px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(255, 107, 53, 0.2);
    transition: all 0.3s ease;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    gap: 8px;
}
.create-event-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 107, 53, 0.3);
    background: #e55a2b;
}
.create-event-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 10px rgba(255, 107, 53, 0.2);
}

.event-list {
    overflow-x: hidden;
    padding-top: 8px;
    margin-top: 10px;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 22px;
    padding: 0 8px;
    width: 100%;
}
.event-item {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 2px 16px rgba(255,107,53,0.08), 0 1.5px 6px rgba(0,0,0,0.04);
    padding: 22px 32px 18px 32px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    position: relative;
    transition: box-shadow 0.2s, transform 0.2s;
    border: 1.5px solid #ffe5d0;
    width: 100%;
    margin: 0 auto;
}
.event-item:hover {
    box-shadow: 0 8px 32px rgba(255,107,53,0.18), 0 2px 8px rgba(0,0,0,0.07);
    transform: translateY(-4px) scale(1.015);
    border-color: #FF6B35;
}
.event-title {
    font-size: 20px;
    font-weight: 700;
    color: #FF6B35;
    margin-bottom: 2px;
    letter-spacing: 0.2px;
}
.event-meta {
    color: #888;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 7px;
}
.event-meta.description {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: normal;
    line-height: 1.4;
    max-height: 2.8em;

    word-break: break-word; /* ðŸŸ  Ã§ok uzun kelimeleri bÃ¶ler */
    overflow-wrap: break-word;
    max-width: 100%;
}

.event-meta i {
    color: #FF6B35;
    font-size: 16px;
    margin-right: 6px;
}
.empty-list {
    text-align: center;
    color: #bbb;
    margin: 60px auto 0 auto;
    font-size: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 18px;
}
.empty-list img {
    width: 120px;
    opacity: 0.7;
}
.event-location {
    position: absolute;
    top: 16px;
    right: 16px;
    background: #fff3e6;
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 14px;
    color: #FF6B35;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
    border: 1px solid #ffe5d0;
}
.event-location i {
    font-size: 14px;
}

/* Modal styles */
.modal-backdrop {
    display: none;
    position: fixed;
    top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.6);
    justify-content: flex-start;
    align-items: center;
    z-index: 9999;
    animation: fadeInBg 0.3s ease;
    backdrop-filter: blur(4px);
    padding-left: 15%;
}
@keyframes fadeInBg {
    from { background: rgba(0,0,0,0.0); backdrop-filter: blur(0px); }
    to { background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); }
}
.modal-content-box {
    background: linear-gradient(135deg, #fff 0%, #fefefe 100%);
    border-radius: 24px;
    width: 500px;
    height: 600px;
    padding: 32px 24px 24px 24px;
    position: relative;
    box-shadow: 0 20px 60px rgba(255,107,53,0.15), 0 8px 32px rgba(0,0,0,0.1);
    animation: modalPop 0.4s cubic-bezier(.68,-0.55,.27,1.55);
    border: 1px solid rgba(255,107,53,0.1);
    overflow-y: auto;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
}
@keyframes modalPop {
    0% { opacity: 0; transform: scale(0.8) translateY(60px); }
    100% { opacity: 1; transform: scale(1) translateY(0); }
}
.modal-close {
    position: absolute;
    top: 16px;
    right: 20px;
    font-size: 24px;
    color: #ff6b35;
    cursor: pointer;
    font-weight: 300;
    background: rgba(255,107,53,0.1);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    border: none;
    line-height: 1;
    z-index: 10;
}
.modal-close:hover {
    background: #ff6b35;
    color: white;
    transform: rotate(90deg) scale(1.1);
    box-shadow: 0 4px 16px rgba(255, 107, 53, 0.3);
}
.modal-close:active {
    transform: rotate(90deg) scale(0.95);
}

.modal-title {
    color: #ff6b35;
    font-weight: 700;
    margin-bottom: 24px;
    letter-spacing: 0.3px;
    font-size: 24px;
    text-align: center;
    position: relative;
    flex-shrink: 0;
}
.modal-title::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 3px;
    background: linear-gradient(90deg, #ff6b35, #ff8c5a);
    border-radius: 2px;
}

.event-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
    flex: 1;
    overflow-y: auto;
    padding-right: 8px;
}
.event-form::-webkit-scrollbar {
    width: 6px;
}
.event-form::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 3px;
}
.event-form::-webkit-scrollbar-thumb {
    background: #ff6b35;
    border-radius: 3px;
}
.event-form::-webkit-scrollbar-thumb:hover {
    background: #e55a2b;
}
.event-form label {
    font-weight: 600;
    color: #444;
    display: block;
    margin-bottom: 6px;
    font-size: 14px;
    letter-spacing: 0.2px;
}
.event-form .input-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
    margin-bottom: 0;
}
.event-form .input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}
.event-form .input-icon {
    position: absolute;
    left: 14px;
    color: #ff6b35;
    font-size: 16px;
    z-index: 2;
    pointer-events: none;
}
.event-form input, .event-form textarea, .event-form select {
    width: 100%;
    padding: 12px 12px 12px 42px;
    border: 2px solid #f0f0f0;
    border-radius: 10px;
    font-size: 14px;
    background: #fafafa;
    transition: all 0.3s ease;
    font-family: inherit;
    color: #333;
}
.event-form input:focus, .event-form textarea:focus, .event-form select:focus {
    border: 2px solid #ff6b35;
    outline: none;
    box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
    background: #fff;
    transform: translateY(-1px);
}
.event-form input::placeholder, .event-form textarea::placeholder {
    color: #999;
    font-weight: 400;
}
.event-form textarea {
    min-height: 80px;
    resize: vertical;
    font-family: inherit;
    line-height: 1.5;
}
.event-form .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}
.event-form select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    cursor: pointer;
    background-image: url("data:image/svg+xml;charset=UTF-8,<svg width='16' height='16' fill='%23ff6b35' xmlns='http://www.w3.org/2000/svg'><path d='M4 6l4 4 4-4'/></svg>");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 14px;
}

.unlimited-checkbox-wrapper {
    margin-top: 6px;
    padding: 12px;
    background: rgba(255,107,53,0.05);
    border-radius: 10px;
    border: 1px solid rgba(255,107,53,0.1);
}
.unlimited-checkbox {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
    color: #555;
    user-select: none;
    cursor: pointer;
    font-weight: 500;
}
.unlimited-checkbox input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: #ff6b35;
    cursor: pointer;
    border-radius: 4px;
}
.unlimited-checkbox span {
    cursor: pointer;
}

.event-form .submit-btn {
    background: linear-gradient(135deg, #ff6b35 0%, #e55a2b 100%);
    color: white;
    border: none;
    border-radius: 10px;
    padding: 14px 28px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 6px 20px rgba(255, 107, 53, 0.25);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    margin-top: 8px;
    letter-spacing: 0.3px;
    position: relative;
    overflow: hidden;
    flex-shrink: 0;
}
.event-form .submit-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s;
}
.event-form .submit-btn:hover::before {
    left: 100%;
}
.event-form .submit-btn:hover {
    background: linear-gradient(135deg, #e55a2b 0%, #d14d20 100%);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(255, 107, 53, 0.35);
}
.event-form .submit-btn:active {
    transform: translateY(0);
    box-shadow: 0 4px 15px rgba(255, 107, 53, 0.25);
}

#editEventModal .modal-content-box {
    background: linear-gradient(135deg, #fff 0%, #fefefe 100%);
    border-radius: 24px;
    width: 500px;
    height: 600px;
    padding: 32px 24px 24px 24px;
    position: relative;
    box-shadow: 0 20px 60px rgba(255,107,53,0.15), 0 8px 32px rgba(0,0,0,0.1);
    animation: modalPop 0.4s cubic-bezier(.68,-0.55,.27,1.55);
    display: flex;
    flex-direction: column;
    border: 1px solid rgba(255,107,53,0.1);
    overflow-y: auto;
    overflow-x: hidden;
}

.toggle-link {
    margin-left: 4px;
    color: #FF6B35;
    font-weight: 600;
    cursor: pointer;
    text-decoration: underline;
    font-size: 14px;
}

.event-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
    justify-content: flex-end;
}
.edit-btn {
    background: #ff6b35;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 8px 20px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(255, 107, 53, 0.15);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}
.edit-btn:hover {
    background: #e55a2b;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 107, 53, 0.25);
}
.edit-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(255, 107, 53, 0.15);
}
.delete-btn {
    background: white;
    color: #ff6b35;
    border: 2px solid #ff6b35;
    border-radius: 8px;
    padding: 8px 20px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(255, 107, 53, 0.1);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}
.delete-btn:hover {
    background: #ff6b35;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 107, 53, 0.2);
}
.delete-btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(255, 107, 53, 0.1);
}

@media (max-width: 600px) {
    .modal-backdrop {
        padding-left: 5%;
        justify-content: center;
    }
    .modal-content-box {
        width: 90vw;
        height: 80vh;
        padding: 24px 16px 16px 16px;
        margin: 0;
    }
    .event-form .form-row {
        grid-template-columns: 1fr;
        gap: 8px;
    }
    .modal-title {
        font-size: 20px;
        margin-bottom: 16px;
    }
    .event-form {
        gap: 12px;
    }
    .event-form input, .event-form textarea, .event-form select {
        padding: 10px 10px 10px 36px;
        font-size: 13px;
    }
    .event-form .input-icon {
        left: 12px;
        font-size: 14px;
    }
}

@media (max-width: 768px) {
    .modal-backdrop {
        padding-left: 8%;
    }
    .modal-content-box {
        width: 450px;
        height: 550px;
    }
    .event-list {
        grid-template-columns: 1fr;
    }
    .create-event-header {
        flex-direction: row;
        gap: 0;
        align-items: flex-start;
    }
    .create-btn-wrapper {
        justify-content: flex-end;
        width: auto;
    }
    .event-item { 
        padding: 14px 6px 12px 6px; 
    }
}

@media (min-width: 1200px) {
    .modal-backdrop {
        padding-left: 20%;
    }
}
</style>

<div class="create-event-header">
    <h2 class="event-title-header">OluÅŸturduÄŸum Etkinlikler</h2>
    <div class="create-btn-wrapper">
        <button class="create-event-btn" onclick="openEventModal()">
            <i class="fas fa-plus-circle"></i>Yeni Etkinlik OluÅŸtur
        </button>
    </div>
</div>

<div class="event-list" id="eventList">
    {% if events %}
        {% for event in events %}
        <div class="event-item" data-capacity="{{ event.capacity }}" data-unlimited="{{ event.unlimited }}" data-date="{{ event.date }}" data-time="{{ event.time }}" data-city="{{ event.city }}" data-district="{{ event.district }}" data-pet_type="{{ event.pet_type }}">
            <div class="event-location">
                <i class="fas fa-map-marker-alt"></i>
                {{ event.city }} / {{ event.district }}
            </div>
            <span class="event-title"> {{ event.title }}</span>

            <!-- Tarih, Saat, TÃ¼r yan yana -->
            <div style="display: flex; gap: 35px; align-items: center;" class="event-meta">
                <span><i class="fas fa-calendar"></i> {{ event.date_display }}</span>
                <span><i class="fas fa-clock"></i> {{ event.time }}</span>
                <span><i class="fas fa-paw"></i> {{ event.pet_type_display }}</span>
            </div>

            <!-- AÃ§Ä±klama -->
            <span class="event-meta description">
                <i class="fas fa-align-left"></i>
                <span class="short-text">{{ event.description|slice:":100" }}{% if event.description|length > 100 %}...{% endif %}</span>
                {% if event.description|length > 100 %}
                    <span class="full-text" style="display:none;">{{ event.description }}</span>
                    <a href="javascript:void(0);" class="toggle-link" onclick="toggleDescription(this)">daha fazla</a>
                {% endif %}
              </span>
              
            {% if event.is_future %}
              <div class="event-actions">
                <button class="edit-btn" onclick="openEditModal('{{ event.id }}', this)">DÃ¼zenle</button>
                <form method="POST" action="/events/{{ event.id }}/delete/" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="delete-btn" onclick="return confirm('Silmek istediÄŸinize emin misiniz?')">Sil</button>
                </form>
              </div>
            {% endif %}
        </div>
        {% endfor %}
    {% else %}
        <div class="empty-list" id="emptyMessage">
            <img src="https://cdn-icons-png.flaticon.com/512/616/616408.png" alt="No events">
            HenÃ¼z hiÃ§ etkinlik oluÅŸturmadÄ±nÄ±z.
        </div>
    {% endif %}
</div>


<!-- Modal -->
<div id="eventModal" class="modal-backdrop">
    <div class="modal-content-box" onclick="event.stopPropagation()">
        <span class="modal-close" onclick="closeEventModal()">&times;</span>
        <h3 class="modal-title">Yeni Etkinlik OluÅŸtur</h3>
        <form class="event-form" id="eventForm" method="POST" action="{% url 'create_events' %}">
            {% csrf_token %}
            
            <!-- BaÅŸlÄ±k -->
            <div class="input-group">
                <label for="title">Etkinlik BaÅŸlÄ±ÄŸÄ±</label>
                <div class="input-wrapper">
                    <span class="input-icon"><i class="fas fa-heading"></i></span>
                    <input type="text" id="title" name="title" required placeholder="Etkinlik baÅŸlÄ±ÄŸÄ±nÄ± girin">
                </div>
            </div>

            <!-- AÃ§Ä±klama -->
            <div class="input-group">
                <label for="description">Etkinlik AÃ§Ä±klamasÄ±</label>
                <div class="input-wrapper">
                    <span class="input-icon"><i class="fas fa-align-left"></i></span>
                    <textarea id="description" name="description" required placeholder="Etkinlik hakkÄ±nda detaylÄ± bilgi verin" rows="4"></textarea>
                </div>
            </div>

            <!-- Hayvan TÃ¼rÃ¼ -->
            <div class="input-group">
                <label for="pet_type">Evcil Hayvan TÃ¼rÃ¼</label>
                <div class="input-wrapper">
                    <span class="input-icon"><i class="fas fa-paw"></i></span>
                    <select id="pet_type" name="pet_type" required>
                        <option value="">Evcil Hayvan TÃ¼rÃ¼ SeÃ§iniz</option>
                    </select>
                </div>
            </div>

            <!-- Ä°l ve Ä°lÃ§e -->
            <div class="form-row">
                <div class="input-group">
                    <label for="city">Ä°l</label>
                    <div class="input-wrapper">
                        <span class="input-icon"><i class="fas fa-map-marker-alt"></i></span>
                        <select id="city" name="city" required>
                            <option value="">Ä°l SeÃ§iniz</option>
                        </select>
                    </div>
                </div>
                <div class="input-group">
                    <label for="district">Ä°lÃ§e</label>
                    <div class="input-wrapper">
                        <span class="input-icon"><i class="fas fa-map-pin"></i></span>
                        <select id="district" name="district" required>
                            <option value="">Ä°lÃ§e SeÃ§iniz</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Tarih ve Saat -->
            <div class="form-row">
                <div class="input-group">
                    <label for="date">Etkinlik Tarihi</label>
                    <div class="input-wrapper">
                        <span class="input-icon"><i class="fas fa-calendar"></i></span>
                        <input type="date" id="date" name="date" required>
                    </div>
                </div>
                <div class="input-group">
                    <label for="time">Etkinlik Saati</label>
                    <div class="input-wrapper">
                        <span class="input-icon"><i class="fas fa-clock"></i></span>
                        <input type="time" id="time" name="time" required>
                    </div>
                </div>
            </div>

            <!-- Kontenjan -->
            <div class="input-group">
                <label for="capacity">Kontenjan</label>
                <div class="input-wrapper">
                    <span class="input-icon"><i class="fas fa-users"></i></span>
                    <input type="number" id="capacity" name="capacity" min="1" placeholder="Maksimum katÄ±lÄ±mcÄ± sayÄ±sÄ±">
                </div>
                <div class="unlimited-checkbox-wrapper">
                    <label class="unlimited-checkbox">
                        <input type="checkbox" id="unlimited" name="unlimited">
                        <span>SÄ±nÄ±rsÄ±z katÄ±lÄ±m</span>
                    </label>
                </div>
            </div>

            <button type="submit" class="submit-btn">
                <i class="fas fa-check-circle"></i> Etkinlik OluÅŸtur
            </button>
        </form>
    </div>
</div>

<!-- DÃ¼zenleme ModalÄ± -->
<div id="editEventModal" class="modal-backdrop" style="display:none;">
  <div class="modal-content-box">
    <span class="modal-close" onclick="closeEditModal()">&times;</span>
    <h3 class="modal-title">EtkinliÄŸi DÃ¼zenle</h3>
    <form id="editEventForm" method="POST" class="event-form">
      {% csrf_token %}
      
      <div class="input-group">
        <label for="edit-title">Etkinlik BaÅŸlÄ±ÄŸÄ±</label>
        <div class="input-wrapper">
          <span class="input-icon"><i class="fas fa-heading"></i></span>
          <input type="text" name="title" id="edit-title" required placeholder="Etkinlik baÅŸlÄ±ÄŸÄ±nÄ± girin">
        </div>
      </div>
      
      <div class="input-group">
        <label for="edit-description">Etkinlik AÃ§Ä±klamasÄ±</label>
        <div class="input-wrapper">
          <span class="input-icon"><i class="fas fa-align-left"></i></span>
          <textarea name="description" id="edit-description" required placeholder="Etkinlik hakkÄ±nda detaylÄ± bilgi verin"></textarea>
        </div>
      </div>
      
      <div class="input-group">
        <label for="edit-pet_type">Evcil Hayvan TÃ¼rÃ¼</label>
        <div class="input-wrapper">
          <span class="input-icon"><i class="fas fa-paw"></i></span>
          <select name="pet_type" id="edit-pet_type" required>
            <option value="">Evcil Hayvan TÃ¼rÃ¼ SeÃ§iniz</option>
          </select>
        </div>
      </div>
      
      <div class="form-row">
        <div class="input-group">
          <label for="edit-city">Ä°l</label>
          <div class="input-wrapper">
            <span class="input-icon"><i class="fas fa-map-marker-alt"></i></span>
            <select name="city" id="edit-city" required>
              <option value="">Ä°l SeÃ§iniz</option>
            </select>
          </div>
        </div>
        <div class="input-group">
          <label for="edit-district">Ä°lÃ§e</label>
          <div class="input-wrapper">
            <span class="input-icon"><i class="fas fa-map-pin"></i></span>
            <select name="district" id="edit-district" required>
              <option value="">Ä°lÃ§e SeÃ§iniz</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="form-row">
        <div class="input-group">
          <label for="edit-date">Etkinlik Tarihi</label>
          <div class="input-wrapper">
            <span class="input-icon"><i class="fas fa-calendar"></i></span>
            <input type="date" id="edit-date" name="date" required>
          </div>
        </div>
        <div class="input-group">
          <label for="edit-time">Etkinlik Saati</label>
          <div class="input-wrapper">
            <span class="input-icon"><i class="fas fa-clock"></i></span>
            <input type="time" id="edit-time" name="time" required>
          </div>
        </div>
      </div>
      
      <div class="input-group">
        <label for="edit-capacity">Kontenjan</label>
        <div class="input-wrapper">
          <span class="input-icon"><i class="fas fa-users"></i></span>
          <input type="number" id="edit-capacity" name="capacity" min="1" placeholder="Maksimum katÄ±lÄ±mcÄ± sayÄ±sÄ±">
        </div>
        <div class="unlimited-checkbox-wrapper">
          <label class="unlimited-checkbox">
            <input type="checkbox" id="edit-unlimited" name="unlimited">
            <span>SÄ±nÄ±rsÄ±z katÄ±lÄ±m</span>
          </label>
        </div>
      </div>
      
      <button type="submit" class="submit-btn">
        <i class="fas fa-save"></i> DeÄŸiÅŸiklikleri Kaydet
      </button>
    </form>
  </div>
</div>

<script>
// TÃ¼rkiye'nin 81 ili ve ilÃ§eleri (Ã¶rnek, tam liste iÃ§in backend veya ayrÄ± bir JS dosyasÄ± kullanÄ±labilir)
const cityDistricts = {
    "Adana": ["Seyhan", "Ã‡ukurova", "YÃ¼reÄŸir", "Ceyhan", "SarÄ±Ã§am", "Kozan", "Ä°mamoÄŸlu", "KarataÅŸ", "KaraisalÄ±", "PozantÄ±", "AladaÄŸ", "Feke", "Saimbeyli", "Tufanbeyli"],
    "AdÄ±yaman": ["Merkez", "Besni", "Kahta", "GÃ¶lbaÅŸÄ±", "Gerger", "Samsat", "Sincik", "Tut", "Ã‡elikhan"],
    "Afyonkarahisar": ["Merkez", "Bolvadin", "Dinar", "EmirdaÄŸ", "SandÄ±klÄ±", "SinanpaÅŸa", "Åžuhut", "Ã‡ay", "Ä°scehisar", "Ä°hsaniye", "Bayat", "BaÅŸmakÃ§Ä±", "Ã‡obanlar", "Evciler", "Hocalar", "KÄ±zÄ±lÃ¶ren", "SultandaÄŸÄ±", "DazkÄ±rÄ±"],
    // ... (tÃ¼m iller ve ilÃ§eler eklenecek, Ã¶rnek olarak birkaÃ§ il eklendi)
    "Ä°stanbul": ["Adalar", "ArnavutkÃ¶y", "AtaÅŸehir", "AvcÄ±lar", "BaÄŸcÄ±lar", "BahÃ§elievler", "BakÄ±rkÃ¶y", "BaÅŸakÅŸehir", "BayrampaÅŸa", "BeÅŸiktaÅŸ", "Beykoz", "BeylikdÃ¼zÃ¼", "BeyoÄŸlu", "BÃ¼yÃ¼kÃ§ekmece", "Ã‡atalca", "Ã‡ekmekÃ¶y", "Esenler", "Esenyurt", "EyÃ¼psultan", "Fatih", "GaziosmanpaÅŸa", "GÃ¼ngÃ¶ren", "KadÄ±kÃ¶y", "KaÄŸÄ±thane", "Kartal", "KÃ¼Ã§Ã¼kÃ§ekmece", "Maltepe", "Pendik", "Sancaktepe", "SarÄ±yer", "Silivri", "Sultanbeyli", "Sultangazi", "Åžile", "ÅžiÅŸli", "Tuzla", "Ãœmraniye", "ÃœskÃ¼dar", "Zeytinburnu"],
    "Ankara": ["AltÄ±ndaÄŸ", "AyaÅŸ", "Bala", "BeypazarÄ±", "Ã‡amlÄ±dere", "Ã‡ankaya", "Ã‡ubuk", "ElmadaÄŸ", "Etimesgut", "Evren", "GÃ¶lbaÅŸÄ±", "GÃ¼dÃ¼l", "Haymana", "Kalecik", "Kahramankazan", "KeÃ§iÃ¶ren", "KÄ±zÄ±lcahamam", "Mamak", "NallÄ±han", "PolatlÄ±", "Pursaklar", "Sincan", "ÅžereflikoÃ§hisar", "Yenimahalle"],
    "Ä°zmir": ["AliaÄŸa", "BalÃ§ova", "BayÄ±ndÄ±r", "Bergama", "BeydaÄŸ", "Bornova", "Buca", "Ã‡eÅŸme", "Ã‡iÄŸli", "Dikili", "FoÃ§a", "Gaziemir", "GÃ¼zelbahÃ§e", "KarabaÄŸlar", "Karaburun", "KarÅŸÄ±yaka", "KemalpaÅŸa", "KÄ±nÄ±k", "Kiraz", "Konak", "Menderes", "Menemen", "NarlÄ±dere", "Ã–demiÅŸ", "Seferihisar", "SelÃ§uk", "Tire", "TorbalÄ±", "Urla"],
    // ... (diÄŸer iller de eklenmeli)
};

// Kategori Ä°ngilizce-TÃ¼rkÃ§e eÅŸleÅŸtirmesi
const petCategories = [
    { value: "Cats", label: "Kedi" },
    { value: "Dogs", label: "KÃ¶pek" },
    { value: "Hamsters", label: "Hamster" },
    { value: "Birds", label: "KuÅŸ" },
    { value: "Fishes", label: "BalÄ±k" },
    { value: "Others", label: "DiÄŸer" }
];

// Åžehirleri doldur
window.addEventListener('DOMContentLoaded', function() {
    const citySelect = document.getElementById('city');
    Object.keys(cityDistricts).sort().forEach(city => {
        const opt = document.createElement('option');
        opt.value = city;
        opt.textContent = city;
        citySelect.appendChild(opt);
    });
    // Kategori doldur
    const petTypeSelect = document.getElementById('pet_type');
    petCategories.forEach(cat => {
        const opt = document.createElement('option');
        opt.value = cat.value;
        opt.textContent = cat.label;
        petTypeSelect.appendChild(opt);
    });
});
// Ä°lÃ§e doldurma
const citySelect = document.getElementById('city');
const districtSelect = document.getElementById('district');
citySelect.addEventListener('change', function() {
    const city = this.value;
    districtSelect.innerHTML = '<option value="">Ä°lÃ§e SeÃ§iniz</option>';
    if (cityDistricts[city]) {
        cityDistricts[city].forEach(d => {
            const opt = document.createElement('option');
            opt.value = d;
            opt.textContent = d;
            districtSelect.appendChild(opt);
        });
    }
});

function openEventModal() {
    document.getElementById('eventModal').style.display = 'flex';
}
function closeEventModal() {
    document.getElementById('eventModal').style.display = 'none';
}
window.onclick = function(event) {
    const modal = document.getElementById('eventModal');
    if (event.target === modal) closeEventModal();
}

function toggleDescription(link) {
    const shortText = link.parentElement.querySelector(".short-text");
    const fullText = link.parentElement.querySelector(".full-text");

    if (fullText.style.display === "none") {
        shortText.style.display = "none";
        fullText.style.display = "inline";
        link.textContent = "daha az";
    } else {
        shortText.style.display = "inline";
        fullText.style.display = "none";
        link.textContent = "daha fazla";
    }
}

function openEditModal(eventId, btn) {
    const card = btn.closest('.event-item');
    document.getElementById('edit-title').value = card.querySelector('.event-title').textContent.trim();
    document.getElementById('edit-description').value = card.querySelector('.short-text').textContent.trim();
    // Pet type
    const petTypeValue = card.getAttribute('data-pet_type');
    document.getElementById('edit-pet_type').value = petTypeValue || '';
    // City & district
    const cityValue = card.getAttribute('data-city');
    const districtValue = card.getAttribute('data-district');
    document.getElementById('edit-city').value = cityValue || '';
    // Ä°lÃ§e selectini doldur
    if (cityDistricts[cityValue]) {
        editDistrictSelect.innerHTML = '<option value="">Ä°lÃ§e SeÃ§iniz</option>';
        cityDistricts[cityValue].forEach(d => {
            const opt = document.createElement('option');
            opt.value = d;
            opt.textContent = d;
            editDistrictSelect.appendChild(opt);
        });
        document.getElementById('edit-district').value = districtValue || '';
    }
    // Tarih ve saat
    document.getElementById('edit-date').value = card.getAttribute('data-date') || '';
    document.getElementById('edit-time').value = card.getAttribute('data-time') || '';
    // Kontenjan ve sÄ±nÄ±rsÄ±z
    const capacity = card.getAttribute('data-capacity');
    const unlimited = card.getAttribute('data-unlimited') === 'true';
    document.getElementById('edit-capacity').value = capacity ? capacity : '';
    document.getElementById('edit-unlimited').checked = unlimited;
    if (unlimited) {
        document.getElementById('edit-capacity').disabled = true;
    } else {
        document.getElementById('edit-capacity').disabled = false;
    }
    document.getElementById('editEventForm').action = `/events/${eventId}/edit/`;
    document.getElementById('editEventModal').style.display = 'flex';
}
function closeEditModal() {
    document.getElementById('editEventModal').style.display = 'none';
}

document.getElementById('unlimited').addEventListener('change', function() {
    const capacityInput = document.getElementById('capacity');
    if (this.checked) {
        capacityInput.disabled = true;
        capacityInput.value = '';
    } else {
        capacityInput.disabled = false;
    }
});

document.getElementById('edit-unlimited').addEventListener('change', function() {
    const capacityInput = document.getElementById('edit-capacity');
    if (this.checked) {
        capacityInput.disabled = true;
        capacityInput.value = '';
    } else {
        capacityInput.disabled = false;
    }
});

// Edit modal iÃ§in selectleri doldur
window.addEventListener('DOMContentLoaded', function() {
    // Pet type
    const editPetTypeSelect = document.getElementById('edit-pet_type');
    if (editPetTypeSelect) {
        editPetTypeSelect.innerHTML = '<option value="">Evcil Hayvan TÃ¼rÃ¼ SeÃ§iniz</option>';
        petCategories.forEach(cat => {
            const opt = document.createElement('option');
            opt.value = cat.value;
            opt.textContent = cat.label;
            editPetTypeSelect.appendChild(opt);
        });
    }
    // City
    const editCitySelect = document.getElementById('edit-city');
    if (editCitySelect) {
        editCitySelect.innerHTML = '<option value="">Ä°l SeÃ§iniz</option>';
        Object.keys(cityDistricts).sort().forEach(city => {
            const opt = document.createElement('option');
            opt.value = city;
            opt.textContent = city;
            editCitySelect.appendChild(opt);
        });
    }
});
// Ä°lÃ§e doldurma (edit modal)
const editCitySelect = document.getElementById('edit-city');
const editDistrictSelect = document.getElementById('edit-district');
if (editCitySelect && editDistrictSelect) {
    editCitySelect.addEventListener('change', function() {
        const city = this.value;
        editDistrictSelect.innerHTML = '<option value="">Ä°lÃ§e SeÃ§iniz</option>';
        if (cityDistricts[city]) {
            cityDistricts[city].forEach(d => {
                const opt = document.createElement('option');
                opt.value = d;
                opt.textContent = d;
                editDistrictSelect.appendChild(opt);
            });
        }
    });
}
// unlimited checkbox ile capacity input iliÅŸkisi (edit modal)
document.getElementById('edit-unlimited').addEventListener('change', function() {
    const capacityInput = document.getElementById('edit-capacity');
    if (this.checked) {
        capacityInput.disabled = true;
        capacityInput.value = '';
    } else {
        capacityInput.disabled = false;
    }
});
</script>
{% endblock %}

