{% extends "home.html" %}
{% block title %}Etkinlik OluÅŸtur | Social Pet{% endblock %}

{% block main_content %}
<style>
.create-event-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 32px;
    padding: 0 8px;
    width: 100%;
}
.event-title-header {
    color: #3f3f3f;
    font-size: 28px;
    left: 0;
    letter-spacing: 0.5px;
}
.create-btn-wrapper {
    display: flex;
    align-items: flex-start;
    justify-content: flex-end;
    flex: 1;
}
.create-event-btn {
    background: linear-gradient(90deg, #FF6B35 60%, #ffb385 100%);
    color: #fff;
    border: none;
    border-radius: 12px;
    padding: 13px 30px;
    font-size: 18px;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 4px 16px rgba(255,107,53,0.12);
    transition: transform 0.18s, box-shadow 0.18s, background 0.3s;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    gap: 8px;
}
.create-event-btn:hover {
    transform: scale(1.04) translateY(-2px);
    box-shadow: 0 8px 32px rgba(255,107,53,0.18);
    background: linear-gradient(90deg, #ffb385 0%, #FF6B35 100%);
}

.event-list {
    margin-top: 10px;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 22px;
    padding: 0 8px;
    width: 100%;
}
.event-item {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 2px 16px rgba(255,107,53,0.08), 0 1.5px 6px rgba(0,0,0,0.04);
    padding: 22px 32px 18px 32px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    position: relative;
    transition: box-shadow 0.2s, transform 0.2s;
    border: 1.5px solid #ffe5d0;
    width: 100%;
    margin: 0 auto;
}
.event-item:hover {
    box-shadow: 0 8px 32px rgba(255,107,53,0.18), 0 2px 8px rgba(0,0,0,0.07);
    transform: translateY(-4px) scale(1.015);
    border-color: #FF6B35;
}
.event-title {
    font-size: 20px;
    font-weight: 700;
    color: #FF6B35;
    margin-bottom: 2px;
    letter-spacing: 0.2px;
}
.event-meta {
    color: #888;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 7px;
}
.event-meta.description {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: normal;
    line-height: 1.4;
    max-height: 2.8em;

    word-break: break-word; /* ðŸŸ  Ã§ok uzun kelimeleri bÃ¶ler */
    overflow-wrap: break-word;
    max-width: 100%;
}

.event-meta i {
    color: #FF6B35;
    font-size: 16px;
    margin-right: 6px;
}
.empty-list {
    text-align: center;
    color: #bbb;
    margin: 60px auto 0 auto;
    font-size: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 18px;
}
.empty-list img {
    width: 120px;
    opacity: 0.7;
}
.event-location {
    position: absolute;
    top: 16px;
    right: 16px;
    background: #fff3e6;
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 14px;
    color: #FF6B35;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
    border: 1px solid #ffe5d0;
}
.event-location i {
    font-size: 14px;
}

/* Modal styles */
.modal-backdrop {
    display: none;
    position: fixed;
    top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.5);
    justify-content: center;
    align-items: center;
    z-index: 9999;
    animation: fadeInBg 0.3s;
}
@keyframes fadeInBg {
    from { background: rgba(0,0,0,0.0); }
    to { background: rgba(0,0,0,0.5); }
}
.modal-content-box {
    background: #fff;
    border-radius: 18px;
    max-width: 420px;
    width: 95%;
    padding: 28px 18px 18px 18px;
    position: relative;
    box-shadow: 0 8px 32px rgba(255,107,53,0.18);
    animation: modalPop 0.35s cubic-bezier(.68,-0.55,.27,1.55);
}
@keyframes modalPop {
    0% { opacity: 0; transform: scale(0.85) translateY(40px); }
    100% { opacity: 1; transform: scale(1) translateY(0); }
}
.modal-close {
    position: absolute;
    top: 12px;
    right: 16px;
    font-size: 22px;
    color: #FF6B35;
    cursor: pointer;
    font-weight: bold;
    background: #fff3e6;
    width: 34px;
    height: 34px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s, color 0.3s;
    border: 1.5px solid #ffe5d0;
}
.modal-close:hover {
    background: #FF6B35;
    color: #fff;
}
.event-form label {
    font-weight: 600;
    margin-top: 8px;
    color: #333;
    display: flex;
    align-items: center;
    gap: 0;
    justify-content: space-between;
}
.event-form .input-group {
    display: flex;
    align-items: center;
    gap: 0;
    margin-bottom: 10px;
}
.event-form .input-icon {
    margin-right: 10px;
    margin-left: 0;
    color: #FF6B35;
    font-size: 18px;
    min-width: 22px;
    text-align: left;
}
.event-form input, .event-form textarea {
    width: 100%;
    padding: 8px 12px 8px 10px;
    border: 1.5px solid #ffe5d0;
    border-radius: 7px;
    font-size: 15px;
    background: #fff8f3;
    transition: border 0.2s, box-shadow 0.2s;
}
.event-form input:focus, .event-form textarea:focus {
    border: 1.5px solid #FF6B35;
    outline: none;
    box-shadow: 0 2px 8px #ffb38533;
}
.event-form textarea {
    min-height: 48px;
    resize: vertical;
}
.event-form .form-row {
    display: flex;
    gap: 10px;
}
.event-form .form-row > div {
    flex: 1;
}
.event-form .submit-btn {
    background: linear-gradient(90deg, #FF6B35 60%, #ffb385 100%);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 12px 0;
    font-size: 17px;
    font-weight: 700;
    cursor: pointer;
    margin-top: 10px;
    width: 100%;
    transition: background 0.2s, box-shadow 0.2s;
    box-shadow: 0 2px 8px #ffb38533;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}
.event-form .submit-btn:hover {
    background: linear-gradient(90deg, #ffb385 0%, #FF6B35 100%);
    box-shadow: 0 4px 16px #ffb38533;
}
.event-list {
    overflow-x: hidden;
    padding-top: 8px;
}

.toggle-link {
    margin-left: 4px;
    color: #FF6B35;
    font-weight: 600;
    cursor: pointer;
    text-decoration: underline;
    font-size: 14px;
}

.event-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
    justify-content: flex-end;
}
.edit-btn {
    background: linear-gradient(90deg, #ffb385 0%, #FF6B35 100%);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 8px 22px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 8px #ffb38533;
    transition: background 0.2s, box-shadow 0.2s, transform 0.15s;
    display: flex;
    align-items: center;
    gap: 7px;
}
.edit-btn:hover {
    background: linear-gradient(90deg, #FF6B35 60%, #ffb385 100%);
    transform: scale(1.04);
}
.delete-btn {
    background: #fff3e6;
    color: #FF6B35;
    border: 1.5px solid #ffe5d0;
    border-radius: 8px;
    padding: 8px 22px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    margin-left: 4px;
    box-shadow: 0 2px 8px #ffb38533;
    transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.15s;
    display: flex;
    align-items: center;
    gap: 7px;
}
.delete-btn:hover {
    background: #FF6B35;
    color: #fff;
    border-color: #FF6B35;
    transform: scale(1.04);
}
#editEventModal .modal-content-box {
    background: #fff;
    border-radius: 18px;
    max-width: 420px;
    width: 95%;
    padding: 32px 22px 22px 22px;
    position: relative;
    box-shadow: 0 8px 32px rgba(255,107,53,0.18);
    animation: modalPop 0.35s cubic-bezier(.68,-0.55,.27,1.55);
    display: flex;
    flex-direction: column;
    align-items: stretch;
}
#editEventModal h3 {
    color: #FF6B35;
    font-weight: 700;
    margin-bottom: 18px;
    letter-spacing: 0.2px;
    font-size: 22px;
    text-align: center;
}
#editEventForm input, #editEventForm textarea {
    width: 100%;
    padding: 8px 12px 8px 10px;
    border: 1.5px solid #ffe5d0;
    border-radius: 7px;
    font-size: 15px;
    background: #fff8f3;
    margin-bottom: 12px;
    transition: border 0.2s, box-shadow 0.2s;
}
#editEventForm input:focus, #editEventForm textarea:focus {
    border: 1.5px solid #FF6B35;
    outline: none;
    box-shadow: 0 2px 8px #ffb38533;
}
#editEventForm .submit-btn {
    background: linear-gradient(90deg, #FF6B35 60%, #ffb385 100%);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 12px 0;
    font-size: 17px;
    font-weight: 700;
    cursor: pointer;
    margin-top: 10px;
    width: 100%;
    transition: background 0.2s, box-shadow 0.2s;
    box-shadow: 0 2px 8px #ffb38533;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}
#editEventForm .submit-btn:hover {
    background: linear-gradient(90deg, #ffb385 0%, #FF6B35 100%);
    box-shadow: 0 4px 16px #ffb38533;
}

@media (max-width: 600px) {
    .event-item { padding: 14px 6px 12px 6px; }
    .event-list { padding: 0; }
    .modal-content-box { padding: 10px 2px 10px 2px; }
}
@media (max-width: 768px) {
    .event-list {
        grid-template-columns: 1fr;
    }
    .create-event-header {
        flex-direction: row;
        gap: 0;
        align-items: flex-start;
    }
    .create-btn-wrapper {
        justify-content: flex-end;
        width: auto;
    }
}
.event-form select {
    width: 100%;
    padding: 8px 12px 8px 10px;
    border: 1.5px solid #ffe5d0;
    border-radius: 7px;
    font-size: 15px;
    background: #fff8f3;
    transition: border 0.2s, box-shadow 0.2s;
    color: #333;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    margin-bottom: 0;
}
.event-form select:focus {
    border: 1.5px solid #FF6B35;
    outline: none;
    box-shadow: 0 2px 8px #ffb38533;
}
.event-form select {
    background-image: url("data:image/svg+xml;charset=UTF-8,<svg width='16' height='16' fill='orange' xmlns='http://www.w3.org/2000/svg'><path d='M4 6l4 4 4-4'/></svg>");
    background-repeat: no-repeat;
    background-position: right 0.75em center;
    background-size: 1.2em;
}
.unlimited-checkbox-wrapper {
    margin-top: -8px;
    margin-bottom: 10px;
}
.unlimited-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 15px;
    color: #666;
    user-select: none;
}
.unlimited-checkbox input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: #FF6B35;
}
</style>

<div class="create-event-header">
    <h2 class="event-title-header">OluÅŸturduÄŸum Etkinlikler</h2>
    <div class="create-btn-wrapper">
        <button class="create-event-btn" onclick="openEventModal()">
            <i class="fas fa-plus-circle"></i>Yeni Etkinlik OluÅŸtur
        </button>
    </div>
</div>

<div class="event-list" id="eventList">
    {% if events %}
        {% for event in events %}
        <div class="event-item" data-capacity="{{ event.capacity }}" data-unlimited="{{ event.unlimited }}" data-date="{{ event.date }}" data-time="{{ event.time }}" data-city="{{ event.city }}" data-district="{{ event.district }}" data-pet_type="{{ event.pet_type }}">
            <div class="event-location">
                <i class="fas fa-map-marker-alt"></i>
                {{ event.city }} / {{ event.district }}
            </div>
            <span class="event-title"> {{ event.title }}</span>

            <!-- Tarih, Saat, TÃ¼r yan yana -->
            <div style="display: flex; gap: 35px; align-items: center;" class="event-meta">
                <span><i class="fas fa-calendar"></i> {{ event.date_display }}</span>
                <span><i class="fas fa-clock"></i> {{ event.time }}</span>
                <span><i class="fas fa-paw"></i> {{ event.pet_type_display }}</span>
            </div>

            <!-- AÃ§Ä±klama -->
            <span class="event-meta description">
                <i class="fas fa-align-left"></i>
                <span class="short-text">{{ event.description|slice:":100" }}{% if event.description|length > 100 %}...{% endif %}</span>
                {% if event.description|length > 100 %}
                    <span class="full-text" style="display:none;">{{ event.description }}</span>
                    <a href="javascript:void(0);" class="toggle-link" onclick="toggleDescription(this)">daha fazla</a>
                {% endif %}
              </span>
              
            {% if event.is_future %}
              <div class="event-actions">
                <button class="edit-btn" onclick="openEditModal('{{ event.id }}', this)">DÃ¼zenle</button>
                <form method="POST" action="/events/{{ event.id }}/delete/" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="delete-btn" onclick="return confirm('Silmek istediÄŸinize emin misiniz?')">Sil</button>
                </form>
              </div>
            {% endif %}
        </div>
        {% endfor %}
    {% else %}
        <div class="empty-list" id="emptyMessage">
            <img src="https://cdn-icons-png.flaticon.com/512/616/616408.png" alt="No events">
            HenÃ¼z hiÃ§ etkinlik oluÅŸturmadÄ±nÄ±z.
        </div>
    {% endif %}
</div>


<!-- Modal -->
<div id="eventModal" class="modal-backdrop">
    <div class="modal-content-box" onclick="event.stopPropagation()">
        <span class="modal-close" onclick="closeEventModal()">&times;</span>
        <h3 style="color:#FF6B35;font-weight:700;margin-bottom:24px;letter-spacing:0.2px;font-size:24px;text-align:center;">Yeni Etkinlik OluÅŸtur</h3>
        <form class="event-form" id="eventForm" method="POST" action="{% url 'create_events' %}">
            {% csrf_token %}
            
            <!-- BaÅŸlÄ±k -->
            <div class="input-group">
                <span class="input-icon"><i class="fas fa-heading"></i></span>
                <input type="text" id="title" name="title" required placeholder="Etkinlik BaÅŸlÄ±ÄŸÄ±">
            </div>

            <!-- AÃ§Ä±klama -->
            <div class="input-group">
                <span class="input-icon"><i class="fas fa-align-left"></i></span>
                <textarea id="description" name="description" required placeholder="Etkinlik AÃ§Ä±klamasÄ±" rows="4"></textarea>
            </div>

            <!-- Hayvan TÃ¼rÃ¼ -->
            <div class="input-group">
                <span class="input-icon"><i class="fas fa-paw"></i></span>
                <select id="pet_type" name="pet_type" required>
                    <option value="">Evcil Hayvan TÃ¼rÃ¼ SeÃ§iniz</option>
                </select>
            </div>

            <!-- Ä°l ve Ä°lÃ§e -->
            <div class="form-row">
                <div class="input-group">
                    <span class="input-icon"><i class="fas fa-map-marker-alt"></i></span>
                    <select id="city" name="city" required>
                        <option value="">Ä°l SeÃ§iniz</option>
                    </select>
                </div>
                <div class="input-group">
                    <span class="input-icon"><i class="fas fa-map-pin"></i></span>
                    <select id="district" name="district" required>
                        <option value="">Ä°lÃ§e SeÃ§iniz</option>
                    </select>
                </div>
            </div>

            <!-- Tarih ve Saat -->
            <div class="form-row">
                <div class="input-group">
                    <span class="input-icon"><i class="fas fa-calendar"></i></span>
                    <input type="date" id="date" name="date" required>
                </div>
                <div class="input-group">
                    <span class="input-icon"><i class="fas fa-clock"></i></span>
                    <input type="time" id="time" name="time" required>
                </div>
            </div>

            <!-- Kontenjan -->
            <div class="input-group">
                <span class="input-icon"><i class="fas fa-users"></i></span>
                <input type="number" id="capacity" name="capacity" min="1" placeholder="Kontenjan">
            </div>
            <div class="unlimited-checkbox-wrapper" style="display: flex; align-items: left; gap: 8px;">
                <label class="unlimited-checkbox">
                    <input type="checkbox" id="unlimited" name="unlimited">
                    <span style="padding-left: 8px; margin-top: 0px;">SÄ±nÄ±rsÄ±z</span>
                </label>
            </div>

            <button type="submit" class="submit-btn">
                <i class="fas fa-check-circle"></i> Etkinlik OluÅŸtur
            </button>
        </form>
    </div>
</div>

<!-- DÃ¼zenleme ModalÄ± -->
<div id="editEventModal" class="modal-backdrop" style="display:none;">
  <div class="modal-content-box">
    <span class="modal-close" onclick="closeEditModal()">&times;</span>
    <h3>EtkinliÄŸi DÃ¼zenle</h3>
    <form id="editEventForm" method="POST" class="event-form">
      {% csrf_token %}
      <div class="input-group">
        <span class="input-icon"><i class="fas fa-heading"></i></span>
        <input type="text" name="title" id="edit-title" required placeholder="Etkinlik BaÅŸlÄ±ÄŸÄ±">
      </div>
      <div class="input-group">
        <span class="input-icon"><i class="fas fa-align-left"></i></span>
        <textarea name="description" id="edit-description" required placeholder="AÃ§Ä±klama"></textarea>
      </div>
      <div class="input-group">
        <span class="input-icon"><i class="fas fa-paw"></i></span>
        <select name="pet_type" id="edit-pet_type" required>
          <option value="">Evcil Hayvan TÃ¼rÃ¼ SeÃ§iniz</option>
        </select>
      </div>
      <div class="form-row">
        <div class="input-group">
          <span class="input-icon"><i class="fas fa-map-marker-alt"></i></span>
          <select name="city" id="edit-city" required>
            <option value="">Ä°l SeÃ§iniz</option>
          </select>
        </div>
        <div class="input-group">
          <span class="input-icon"><i class="fas fa-map-pin"></i></span>
          <select name="district" id="edit-district" required>
            <option value="">Ä°lÃ§e SeÃ§iniz</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="input-group">
          <span class="input-icon"><i class="fas fa-calendar"></i></span>
          <input type="date" id="edit-date" name="date" required placeholder="Etkinlik Tarihi">
        </div>
        <div class="input-group">
          <span class="input-icon"><i class="fas fa-clock"></i></span>
          <input type="time" id="edit-time" name="time" required placeholder="Etkinlik Saati">
        </div>
      </div>
      <div class="input-group">
        <span class="input-icon"><i class="fas fa-users"></i></span>
        <input type="number" id="edit-capacity" name="capacity" min="1" placeholder="Kontenjan">
      </div>
      <div class="unlimited-checkbox-wrapper" style="display: flex; align-items: left; gap: 8px;">
        <label class="unlimited-checkbox">
          <input type="checkbox" id="edit-unlimited" name="unlimited">
          <span style="padding-left: 8px; margin-top: -13px;">SÄ±nÄ±rsÄ±z</span>
        </label>
      </div>
      <button type="submit" class="submit-btn">
        <i class="fas fa-check-circle"></i> Kaydet
      </button>
    </form>
  </div>
</div>

<script>
// TÃ¼rkiye'nin 81 ili ve ilÃ§eleri (Ã¶rnek, tam liste iÃ§in backend veya ayrÄ± bir JS dosyasÄ± kullanÄ±labilir)
const cityDistricts = {
    "Adana": ["Seyhan", "Ã‡ukurova", "YÃ¼reÄŸir", "Ceyhan", "SarÄ±Ã§am", "Kozan", "Ä°mamoÄŸlu", "KarataÅŸ", "KaraisalÄ±", "PozantÄ±", "AladaÄŸ", "Feke", "Saimbeyli", "Tufanbeyli"],
    "AdÄ±yaman": ["Merkez", "Besni", "Kahta", "GÃ¶lbaÅŸÄ±", "Gerger", "Samsat", "Sincik", "Tut", "Ã‡elikhan"],
    "Afyonkarahisar": ["Merkez", "Bolvadin", "Dinar", "EmirdaÄŸ", "SandÄ±klÄ±", "SinanpaÅŸa", "Åžuhut", "Ã‡ay", "Ä°scehisar", "Ä°hsaniye", "Bayat", "BaÅŸmakÃ§Ä±", "Ã‡obanlar", "Evciler", "Hocalar", "KÄ±zÄ±lÃ¶ren", "SultandaÄŸÄ±", "DazkÄ±rÄ±"],
    // ... (tÃ¼m iller ve ilÃ§eler eklenecek, Ã¶rnek olarak birkaÃ§ il eklendi)
    "Ä°stanbul": ["Adalar", "ArnavutkÃ¶y", "AtaÅŸehir", "AvcÄ±lar", "BaÄŸcÄ±lar", "BahÃ§elievler", "BakÄ±rkÃ¶y", "BaÅŸakÅŸehir", "BayrampaÅŸa", "BeÅŸiktaÅŸ", "Beykoz", "BeylikdÃ¼zÃ¼", "BeyoÄŸlu", "BÃ¼yÃ¼kÃ§ekmece", "Ã‡atalca", "Ã‡ekmekÃ¶y", "Esenler", "Esenyurt", "EyÃ¼psultan", "Fatih", "GaziosmanpaÅŸa", "GÃ¼ngÃ¶ren", "KadÄ±kÃ¶y", "KaÄŸÄ±thane", "Kartal", "KÃ¼Ã§Ã¼kÃ§ekmece", "Maltepe", "Pendik", "Sancaktepe", "SarÄ±yer", "Silivri", "Sultanbeyli", "Sultangazi", "Åžile", "ÅžiÅŸli", "Tuzla", "Ãœmraniye", "ÃœskÃ¼dar", "Zeytinburnu"],
    "Ankara": ["AltÄ±ndaÄŸ", "AyaÅŸ", "Bala", "BeypazarÄ±", "Ã‡amlÄ±dere", "Ã‡ankaya", "Ã‡ubuk", "ElmadaÄŸ", "Etimesgut", "Evren", "GÃ¶lbaÅŸÄ±", "GÃ¼dÃ¼l", "Haymana", "Kalecik", "Kahramankazan", "KeÃ§iÃ¶ren", "KÄ±zÄ±lcahamam", "Mamak", "NallÄ±han", "PolatlÄ±", "Pursaklar", "Sincan", "ÅžereflikoÃ§hisar", "Yenimahalle"],
    "Ä°zmir": ["AliaÄŸa", "BalÃ§ova", "BayÄ±ndÄ±r", "Bergama", "BeydaÄŸ", "Bornova", "Buca", "Ã‡eÅŸme", "Ã‡iÄŸli", "Dikili", "FoÃ§a", "Gaziemir", "GÃ¼zelbahÃ§e", "KarabaÄŸlar", "Karaburun", "KarÅŸÄ±yaka", "KemalpaÅŸa", "KÄ±nÄ±k", "Kiraz", "Konak", "Menderes", "Menemen", "NarlÄ±dere", "Ã–demiÅŸ", "Seferihisar", "SelÃ§uk", "Tire", "TorbalÄ±", "Urla"],
    // ... (diÄŸer iller de eklenmeli)
};

// Kategori Ä°ngilizce-TÃ¼rkÃ§e eÅŸleÅŸtirmesi
const petCategories = [
    { value: "Cats", label: "Kedi" },
    { value: "Dogs", label: "KÃ¶pek" },
    { value: "Hamsters", label: "Hamster" },
    { value: "Birds", label: "KuÅŸ" },
    { value: "Fishes", label: "BalÄ±k" },
    { value: "Others", label: "DiÄŸer" }
];

// Åžehirleri doldur
window.addEventListener('DOMContentLoaded', function() {
    const citySelect = document.getElementById('city');
    Object.keys(cityDistricts).sort().forEach(city => {
        const opt = document.createElement('option');
        opt.value = city;
        opt.textContent = city;
        citySelect.appendChild(opt);
    });
    // Kategori doldur
    const petTypeSelect = document.getElementById('pet_type');
    petCategories.forEach(cat => {
        const opt = document.createElement('option');
        opt.value = cat.value;
        opt.textContent = cat.label;
        petTypeSelect.appendChild(opt);
    });
});
// Ä°lÃ§e doldurma
const citySelect = document.getElementById('city');
const districtSelect = document.getElementById('district');
citySelect.addEventListener('change', function() {
    const city = this.value;
    districtSelect.innerHTML = '<option value="">Ä°lÃ§e SeÃ§iniz</option>';
    if (cityDistricts[city]) {
        cityDistricts[city].forEach(d => {
            const opt = document.createElement('option');
            opt.value = d;
            opt.textContent = d;
            districtSelect.appendChild(opt);
        });
    }
});

function openEventModal() {
    document.getElementById('eventModal').style.display = 'flex';
}
function closeEventModal() {
    document.getElementById('eventModal').style.display = 'none';
}
window.onclick = function(event) {
    const modal = document.getElementById('eventModal');
    if (event.target === modal) closeEventModal();
}

function toggleDescription(link) {
    const shortText = link.parentElement.querySelector(".short-text");
    const fullText = link.parentElement.querySelector(".full-text");

    if (fullText.style.display === "none") {
        shortText.style.display = "none";
        fullText.style.display = "inline";
        link.textContent = "daha az";
    } else {
        shortText.style.display = "inline";
        fullText.style.display = "none";
        link.textContent = "daha fazla";
    }
}

function openEditModal(eventId, btn) {
    const card = btn.closest('.event-item');
    document.getElementById('edit-title').value = card.querySelector('.event-title').textContent.trim();
    document.getElementById('edit-description').value = card.querySelector('.short-text').textContent.trim();
    // Pet type
    const petTypeValue = card.getAttribute('data-pet_type');
    document.getElementById('edit-pet_type').value = petTypeValue || '';
    // City & district
    const cityValue = card.getAttribute('data-city');
    const districtValue = card.getAttribute('data-district');
    document.getElementById('edit-city').value = cityValue || '';
    // Ä°lÃ§e selectini doldur
    if (cityDistricts[cityValue]) {
        editDistrictSelect.innerHTML = '<option value="">Ä°lÃ§e SeÃ§iniz</option>';
        cityDistricts[cityValue].forEach(d => {
            const opt = document.createElement('option');
            opt.value = d;
            opt.textContent = d;
            editDistrictSelect.appendChild(opt);
        });
        document.getElementById('edit-district').value = districtValue || '';
    }
    // Tarih ve saat
    document.getElementById('edit-date').value = card.getAttribute('data-date') || '';
    document.getElementById('edit-time').value = card.getAttribute('data-time') || '';
    // Kontenjan ve sÄ±nÄ±rsÄ±z
    const capacity = card.getAttribute('data-capacity');
    const unlimited = card.getAttribute('data-unlimited') === 'true';
    document.getElementById('edit-capacity').value = capacity ? capacity : '';
    document.getElementById('edit-unlimited').checked = unlimited;
    if (unlimited) {
        document.getElementById('edit-capacity').disabled = true;
    } else {
        document.getElementById('edit-capacity').disabled = false;
    }
    document.getElementById('editEventForm').action = `/events/${eventId}/edit/`;
    document.getElementById('editEventModal').style.display = 'flex';
}
function closeEditModal() {
    document.getElementById('editEventModal').style.display = 'none';
}

document.getElementById('unlimited').addEventListener('change', function() {
    const capacityInput = document.getElementById('capacity');
    if (this.checked) {
        capacityInput.disabled = true;
        capacityInput.value = '';
    } else {
        capacityInput.disabled = false;
    }
});

document.getElementById('edit-unlimited').addEventListener('change', function() {
    const capacityInput = document.getElementById('edit-capacity');
    if (this.checked) {
        capacityInput.disabled = true;
        capacityInput.value = '';
    } else {
        capacityInput.disabled = false;
    }
});

// Edit modal iÃ§in selectleri doldur
window.addEventListener('DOMContentLoaded', function() {
    // Pet type
    const editPetTypeSelect = document.getElementById('edit-pet_type');
    if (editPetTypeSelect) {
        editPetTypeSelect.innerHTML = '<option value="">Evcil Hayvan TÃ¼rÃ¼ SeÃ§iniz</option>';
        petCategories.forEach(cat => {
            const opt = document.createElement('option');
            opt.value = cat.value;
            opt.textContent = cat.label;
            editPetTypeSelect.appendChild(opt);
        });
    }
    // City
    const editCitySelect = document.getElementById('edit-city');
    if (editCitySelect) {
        editCitySelect.innerHTML = '<option value="">Ä°l SeÃ§iniz</option>';
        Object.keys(cityDistricts).sort().forEach(city => {
            const opt = document.createElement('option');
            opt.value = city;
            opt.textContent = city;
            editCitySelect.appendChild(opt);
        });
    }
});
// Ä°lÃ§e doldurma (edit modal)
const editCitySelect = document.getElementById('edit-city');
const editDistrictSelect = document.getElementById('edit-district');
if (editCitySelect && editDistrictSelect) {
    editCitySelect.addEventListener('change', function() {
        const city = this.value;
        editDistrictSelect.innerHTML = '<option value="">Ä°lÃ§e SeÃ§iniz</option>';
        if (cityDistricts[city]) {
            cityDistricts[city].forEach(d => {
                const opt = document.createElement('option');
                opt.value = d;
                opt.textContent = d;
                editDistrictSelect.appendChild(opt);
            });
        }
    });
}
// unlimited checkbox ile capacity input iliÅŸkisi (edit modal)
document.getElementById('edit-unlimited').addEventListener('change', function() {
    const capacityInput = document.getElementById('edit-capacity');
    if (this.checked) {
        capacityInput.disabled = true;
        capacityInput.value = '';
    } else {
        capacityInput.disabled = false;
    }
});
</script>
{% endblock %}

